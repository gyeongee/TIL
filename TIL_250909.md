### LangChain
- chain.invoke() 
   Langchain에서 invoke(input)는 Runnable 객체를 실행시키는 메서드
   - Runnable은 함수, 체인, tool등 다양한 형태가 될 수 있음
   - 1. tools.invoke(Python code) : Python code 실행()
```
        tools=PythonREPLTool()
        tools.invoke(code)
```
    - 2. chain.invoke("퀵소트를 수행하는 코드를 작성해주세요.)
```
chain = prompt | llm | StrOutputParser() | RunnableLambda(print_and_execute)
chain.invoke("퀵소트를 수행하는 코드를 작성해주세요 입력데이터는 알아서 10개를 넣어주세요")
```
    - chain은 prompt -> LLM -> parser -> 코드 실행을 연결한 체인
    - invoke() 안에 들어가는 input은 사용자 질문/요청(prompt)
    - 체인 안에서 순서대로 처리됨

| temperature | 출력 특징                             |
| ----------- | --------------------------------- |
| 0           | 항상 가장 확실한 답, 결정론적, 반복 시 결과 동일     |
| 0.3         | 조금 유연하게 선택, 약간의 다양성               |
| 0.7\~1.0    | 창의적이고 다양한 결과 가능, 같은 입력에도 다른 출력 가능 |

예시) 파이썬 코드생성기 및 컴파일러 제작하기
  ```
  from langchain_openai import ChatOpenAI
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.output_parsers import StrOutputParser
from langchain_core.runnables import RunnableLambda
from langchain_experimental.tools import PythonREPLTool

tools = PythonREPLTool()

# 생성한 코드를 실행하고 출력하는 함수
# debug=True => 생성된 코드와 실행 결과 구분선을 출력
def print_and_execute(code, debug=True) :
    # bebug가 True라서 print문 실행 가능
    if debug :
        print(code)
        print("\n==== 실행결과 ====")

    # 코드 실행 결과 반환
    return tools.invoke(code)

### 코드를 생성하는 프롬프트 작성
prompt = ChatPromptTemplate.from_messages(
  [
      ("system",
       """당신은 전문 파이썬 프로그래머이다. 메타 프로그래밍과 우아하고 간결하며
          짧지만 잘 문서화된 코드에 정통합니다. 당신은 PEP8 스타일 가이드를 따릅니다.
          소개도 없고, 설명도 없고, 잡담도 없고, 마크다운도 없고, 코드 블록도 없고,
          아무것도 반환하지 않고 코드만 반환합니다
       """),
      ("human", "{input}")
  ]
)
# llm에 전달 -> 코드 문자열 생성
llm = ChatOpenAI(model="gpt-4o", temperature=0)

# StrOutputParser() : LLM 출력에서 순수 문자열만 추출
# RunnableLamda() : 코드를 실제로 실행하고 출력/결과 반환(함수 -> 도구)
chain = prompt | llm | StrOutputParser() | RunnableLambda(print_and_execute)


print(chain.invoke("퀵소트를 수행하는 코드를 작성해주세요 입력데이터는 알아서 10개를 넣어주세요"))
```

### 파이썬 함수를 도구로 사용하기
- @tool 데코레이터를 사용하여 사용자가 직접 도구를 정의하여 사용
  
```
from langchain.tools import tool

# 함수를 도구로 만드는 데코레이터
# 반드시 docstring을 넣어주어야 한다
@tool
def add_numbers(a:int, b:int) -> int:
    """ 두 수를 입력받아 합을 반환하는 도구 """
     return a+b
add_numbers.invoke({"a":3,"b":4})
```

### LLM에 사용자 정의 도구 바인딩하기
```
from langchain_openai import ChatOpenAI
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.prompts import MessagesPlaceholder

# 정의한 도구 목록을 저장
tools - [add_numbers]

llm = ChatPromptTemplate.from_messages(
    [
        ("system":"당신은 강력한 에이전트입니다."),
        ("user":"{input}),
        # 중간 메시지를 저장하기 위한 것
        #agent_scratchpad:에이전트가 작업 도중 남기는 기록공간
        MessagesPlaceholder(variable_name="agent_scratchpad")
    ]
)
```