### 1.1. Crowd Counting
Crowd counting은 이미지나 비디오를 분석해 특정 공간 내 인원 수를 세는 기술입니다. 군중 밀도가 높은 곳에서 안전 관리를 하거나, 공공 시설의 혼잡도를 예측하고, 마케팅 이벤트에서 방문자 수를 추적하는 데 유용합니다. 최근 딥러닝의 발전으로 인해, 더 정밀한 군중 수를 예측할 수 있게 되면서 다양한 실용적인 활용 사례가 늘고 있습니다.
1.2 활용 사례
Crowd Counting은 다음과 같은 다양한 분야에서 사용되고 있습니다. 
 

스마트 시티 : 공공장소에서 실시간 인원 관리를 통해 안전과 편의를 증대
대중교통 : 지하철역, 버스 정류장 등의 혼잡도를 분석하여 효율적인 운영 가능
이벤트 관리 : 콘서트, 축제 등에서 군중의 밀도를 파악해 안전 문제 예방
보안 및 감시 : 대규모 시위나 공공장소에서 이상 현상을 빠르게 탐지

 
 
2. 딥러닝 기반 Crowd Counting 개요
2.1. 기존 방법과 딥러닝 기반 접근법 비교
전통적인 기술은 주로 컴퓨터 비전과 머신러닝 기법을 활용해 객체 탐지 후 개체 수를 셉니다. 그러나 군중 밀도가 높을 때는 객체가 겹쳐 보여 정확도가 떨어지는 단점이 있습니다. 딥러닝 기반 접근법은 이미지에서 밀도 맵을 생성해 객체를 일일이 탐지하지 않고도 인원 수를 추정할 수 있어 더 높은 정확도를 보장합니다.
 
2.2. 딥러닝을 활용한 Crowd Counting의 기본 원리
딥러닝 기반 crowd counting은 주로 밀도 맵(Density Map*) 을 생성해 이미지 내의 군중 밀도를 시각화하고 이를 바탕으로 사람 수를 추정합니다. CNN(Convolutional Neural Network) 구조를 이용해 이미지의 패턴을 학습하고, 픽셀 단위로 밀도 값을 예측하여 군중 수를 계산하는 방법을 적용합니다. 
 
그 외에도 Object Detection 기반 방식과 Vision-Language Model를 기반으로 하는 방식 등이 있습니다. 각각 Yolo-Crowd와 CrowdCLIP 과 같은 모델들이 대표적인 예라고 할 수 있습니다. 
 
 
* 밀도맵 (Density Map)이란 이미지나 비디오 프레임에서 객체의 밀도를 표현하는 2차원 배열 형태의 출력으로, Crowd Counting에서는 각 픽셀에 사람이 존재할 확률을 나태내며 높은 값을 가진 부분일수록 더 많은 사람들이 밀집해 있다는 것을 의미합니다. 밀도맵의 모든 값을 환산하면 총 인원수를 추정할 수 있습니다. 기존의 방식은 모든 사람의 정확한 위치와 경계를 찾아야 하므로 복잡한 환경에서는 정확도가 떨어질 수 있습니다. 밀도맵을 이용하는 경우는 개체 별 경계를 구분하지 않으므로 더 높은 성능을 보일 수 있고 고밀도 군중 상황에서도 겹쳐 있는 객체들도 정확하게 수를 셀 수 있다는 장점이 있습니다. 
 
 
2.3. 주요 모델 개요
밀도맵 방식을 이용하는 대표적인 딥러닝 기반 모델로는 CSRNet, MCNN, CAN 등이 있습니다.

CSRNet은 기존의 CNN 구조에 dilated convolution을 추가해 밀도 예측의 정확도를 높였습니다.
MCNN(Multi-Column CNN)은 서로 다른 크기의 필터가 적용된 다중 컬럼 네트워크를 통해 다양한 군중 밀도를 파악합니다.
CAN(Context-Aware Network)은 이미지의 문맥 정보를 활용해 보다 정확한 예측을 수행합니다.

이번 테스트는 LWCC라는 Python용 경량 Crowd Counting 프레임워크를 이용합니다. LWCC는 CSRNet, DM-Count, SFANet, Baysian Crowd Counting의 4가지 모델을 지원합니다. 
 
### LWCC
- 코랩에서 진행
```
!pip install lwcc
from lwcc import LWCC

# 사용할 이미지 출력
from PIL import Image

img = Image.open('./data/img01.jpg')

plt.imshow(img)
plt.axis('off')
plt.show()

# 카운트 추청
# SHA(기본값)으로 사전 학습된 CSRNet 사용
img = './data/img01.jpg'
count, density = LWCC.get_count(img, return_density = True)


# 35명(소수점 첫번째 자리에서 반올림) 탐지
print(count)
# 결과 : np.float32(34.416668)

# density map 출력
plt.imshow(density)
plt.show()
```
C:\TIL\TIL.250914.md